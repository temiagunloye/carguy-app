<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manual Part Ingestion & Demo Seed Guide</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            max-width: 900px;
            margin: 40px auto;
            padding: 20px;
            background: #f5f5f5;
        }

        .container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: #1a73e8;
            margin-top: 0;
        }

        .step {
            margin: 20px 0;
            padding: 15px;
            border-left: 4px solid #1a73e8;
            background: #f8f9fa;
        }

        .step h3 {
            margin-top: 0;
        }

        pre {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 6px;
            overflow-x: auto;
        }

        button {
            background: #1a73e8;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
        }

        button:hover {
            background: #1557b0;
        }

        .file-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
        }

        .part-card {
            border: 1px solid #ddd;
            padding: 15px;
            border-radius: 8px;
            background: white;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>ðŸ“¦ Manual Ingestion & Seed Tool</h1>

        <div class="step">
            <h3>Step 1: Upload Files</h3>
            <p>Upload files from <code>carguy-app/assets/parts-raw/</code> to Firebase Storage at these paths:</p>
            <ul>
                <li><code>models/parts/wheel_aftermarket_01/v1/model.glb</code></li>
                <li><code>models/parts/front_lip_01/v1/model.glb</code></li>
                <li><code>models/parts/side_skirt_01/v1/model.glb</code></li>
                <li><code>models/parts/rear_diffuser_01/v1/model.glb</code></li>
            </ul>
        </div>

        <div class="step">
            <h3>Step 2: Register Parts</h3>
            <p>Create these documents in <code>parts</code> collection.</p>
            <div class="file-list" id="parts-container"></div>
        </div>

        <div class="step">
            <h3>Step 3: Seed Demo Inventory</h3>
            <p>Update the Demo Car documents in <code>cars</code> collection to include these parts for "Install" UI.
            </p>
            <div class="file-list" id="inventory-container"></div>
        </div>
    </div>

    <script>
        const PARTS = [
            {
                id: 'wheel_aftermarket_01',
                displayName: 'Aftermarket 5-Spoke',
                category: 'wheel',
                storagePath: 'models/parts/wheel_aftermarket_01/v1/model.glb',
                displayPath: 'models/parts/wheel_aftermarket_01/v1/model.glb',
                defaults: {
                    anchorPattern: 'ANCHOR_WHEEL_*',
                    scaleMode: 'relativeToWheelAnchors',
                    offset: { x: 0, y: 0, z: 0 },
                    rotation: { x: 0, y: 0, z: 0 }
                }
            },
            {
                id: 'front_lip_01',
                displayName: 'Carbon Splitter',
                category: 'front_lip',
                storagePath: 'models/parts/front_lip_01/v1/model.glb',
                displayPath: 'models/parts/front_lip_01/v1/model.glb',
                defaults: {
                    anchorName: 'ANCHOR_FRONT_CENTER_LOW',
                    scaleMode: 'relativeToCarWidth',
                    offset: { x: 0, y: -0.05, z: 0 },
                    rotation: { x: 0, y: 0, z: 0 }
                }
            },
            {
                id: 'side_skirt_01',
                displayName: 'Aero Side Skirts',
                category: 'side_skirt',
                storagePath: 'models/parts/side_skirt_01/v1/model.glb',
                displayPath: 'models/parts/side_skirt_01/v1/model.glb',
                defaults: {
                    anchorPattern: 'ANCHOR_SIDE_*_LOW',
                    scaleMode: 'relativeToWheelbase',
                    offset: { x: 0, y: -0.05, z: 0 },
                    rotation: { x: 0, y: 0, z: 0 }
                }
            },
            {
                id: 'rear_diffuser_01',
                displayName: 'Race Diffuser',
                category: 'rear_diffuser',
                storagePath: 'models/parts/rear_diffuser_01/v1/model.glb',
                displayPath: 'models/parts/rear_diffuser_01/v1/model.glb',
                defaults: {
                    anchorName: 'ANCHOR_REAR_CENTER_LOW',
                    scaleMode: 'relativeToCarWidth',
                    offset: { x: 0, y: -0.05, z: 0 },
                    rotation: { x: 0, y: 0, z: 0 }
                }
            }
        ];

        const container = document.getElementById('parts-container');
        PARTS.forEach(part => {
            const data = {
                partId: part.id,
                displayName: part.displayName,
                category: part.category,
                storagePath: part.storagePath,
                active: true,
                compatibleAnchorsVersion: 'v1',
                activeVersion: 'v1',
                placementDefaults: part.defaults,
                license: { type: 'Generated', sourceUrl: 'Internal' },
                qualityScore: 3,
                createdAt: new Date(),
                updatedAt: new Date()
            };

            const card = document.createElement('div');
            card.className = 'part-card';
            card.innerHTML = `
                <h4>${part.displayName}</h4>
                <p>ID: <code>${part.id}</code></p>
                <button onclick="copyData('${part.id}')">ðŸ“‹ Copy Part JSON</button>
                <div id="status-${part.id}" style="margin-top:5px;font-size:12px;color:green"></div>
            `;
            container.appendChild(card);
            window['data_' + part.id] = JSON.stringify(data, null, 2);
        });

        // Demo Inventory Seed
        const invContainer = document.getElementById('inventory-container');
        const DEMO_INVENTORY = PARTS.map(p => ({
            id: 'demo_' + p.category,
            partId: p.id,
            name: p.displayName,
            category: p.category,
            status: 'in_storage',
            createdAt: new Date()
        }));

        const demoData = {
            parts: DEMO_INVENTORY,
            renderStatus: 'ready'
        };

        const seedCard = document.createElement('div');
        seedCard.className = 'part-card';
        seedCard.innerHTML = `
            <h4>Update Demo Cars</h4>
            <p>Cars: <code>porsche_911_2024</code>, <code>bmw_m3_2023</code>, <code>subaru_brz_2022</code></p>
            <p>Paste this into the 'parts' field (array) of each car doc in 'cars' collection.</p>
            <button onclick="copySeed()">ðŸ“‹ Copy Inventory JSON</button>
            <div id="status-seed" style="margin-top:5px;font-size:12px;color:green"></div>
        `;
        invContainer.appendChild(seedCard);
        window.seedDataString = JSON.stringify(demoData, null, 2);

        function copyData(id) {
            navigator.clipboard.writeText(window['data_' + id]);
            document.getElementById('status-' + id).innerText = 'Copied!';
        }
        function copySeed() {
            navigator.clipboard.writeText(window.seedDataString);
            document.getElementById('status-seed').innerText = 'Copied! Update each demo car doc.';
        }
    </script>
</body>

</html>